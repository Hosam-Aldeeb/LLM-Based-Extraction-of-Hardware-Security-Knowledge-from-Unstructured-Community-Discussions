ECE722 LAB 3 - COMPREHENSIVE SUMMARY FOR CHATGPT
Generated: 11/11/2025, 8:50 PM
Source: 330 Discord messages from homework-help channel (Nov 4-11, 2025)

======================================================================
COPY EVERYTHING BELOW THIS LINE AND PASTE INTO CHATGPT
======================================================================

I'm working on ECE722 Lab 3 (128-bit Ripple Carry Adder + Carry-Select Adder design with pipelining). Below is a comprehensive summary of all discussions from the homework-help Discord channel (Nov 4-11, 2025). Please help me understand the key concepts and solve any issues I'm facing.

======================================================================
LAB 3 OVERVIEW
======================================================================

**What is Lab 3?**
- Design and implement a 128-bit Ripple Carry Adder (RCA) in SystemVerilog
- Create both non-pipelined (rca.sv) and pipelined (rca_pipe.sv) versions
- Also implement Carry-Select Adder (CSA) variants (csa.sv, csa__pipe.sv)
- Synthesize designs using Quartus (Intel FPGA tools)
- Perform timing analysis and optimize for Fmax
- Test with Verilator simulation
- Generate CSV reports with timing and area metrics

**Key Files:**
- `rtl/rca.sv` - 128-bit non-pipelined RCA with input/output registers
- `rtl/rca_pipe.sv` - Pipelined RCA (instantiates rca.sv, adds pipeline registers every M bits)
- `rtl/csa.sv` - Carry-Select Adder (non-pipelined)
- `rtl/csa_pipe.sv` - Pipelined CSA
- `tb/test_adder.sv` - Testbench
- `tb/test.cpp` - C++ test driver
- `Makefile` - Build and test commands
- `extract.sh` - Script to extract timing/area metrics from Quartus reports
- `env.sh` - Environment setup for Quartus/Verilator
- `fpga/setup.tcl` - Quartus synthesis setup
- `fpga/adder.sdc` - Timing constraints (1ns clock period for pipelined designs)

**Timeline:**
- Lab 3 due: ~10 days from Nov 5 (around Nov 15, 2025)
- Professor checked progress on Nov 5 - only 2 students had started!
- Professor's comment: "so much easier and not buggy as lab2. what gives?"

**Grading:**
- Student asked: "How will this be graded? If we achieve certain fmax or area targets?"
- Professor: "This is a graduate course. Do your best."
- No binary grading - it's about optimization and understanding

======================================================================
KEY TECHNICAL CONCEPTS
======================================================================

**1. RCA (Ripple Carry Adder) Architecture:**
- 128-bit adder with carry rippling through all bits
- Must have input and output registers (bounding registers) for timing analysis
- Non-pipelined version (rca.sv): Input regs â†’ Adder logic â†’ Output regs
- Pipelined version (rca_pipe.sv): Instantiates rca.sv modules, adds pipeline registers every M bits

**2. CSA (Carry-Select Adder) Architecture:**
- More complex than RCA - uses diagonal carry propagation
- **CRITICAL DISCOVERY (Nov 11):** The textbook diagram is incomplete!
  - Students discovered the diagonal carry logic was missing width specifications
  - After extensive discussion with professor, they proved:
    - Diagonal adders DON'T need to be W+1 bits (can stay W bits)
    - Only ONE of the two carries (first row carry OR diagonal carry) can be 1 at a time
    - Use OR gate (or XOR) to combine the two carry outputs
    - The diagonal adder with B=0 can only PROPAGATE carry, never GENERATE its own
  - Professor: "I think we can prove that W-bit adder is enough"
  - Professor: "If the first row adder generates carry its game over for cascaded carry coming in â€” it must be absorbed in that adder"
  - Students joked: "can we get our names on the next edition of the book?"

**3. Pipelining Parameter M:**
- M = number of Full Adders (FAs) per pipeline chunk
- Example: W=128, M=2 â†’ each pipeline stage adds 64 bits
- Example: W=128, M=3 â†’ stages add 43, 43, 42 bits respectively
- **M does NOT have to be a power of 2!** (Professor emphasized this)
- M doesn't have to divide W evenly (can have remainders)
- Smaller M â†’ more pipeline stages â†’ higher Fmax â†’ more registers â†’ more ALMs

**4. Timing Analysis:**
- Fmax (maximum frequency) is reported by Quartus
- Fmax measures: largest propagation delay from input register â†’ output register
- 1ns clock constraint is for pipelined designs (non-pipelined RCA won't meet 1ns)
- Report slack as you see it (negative slack = timing violation)

**5. Area Metrics:**
- ALMs (Adaptive Logic Modules) - FPGA resource usage
- "Reasonable ALM usage" = strictly necessary ALMs + 5-10% tolerance
- Exclude ALMs_VIRTUAL_IO from count
- More pipelining â†’ more registers â†’ more ALMs
- Professor: "you should reason about how many ALMs would be strictly necessary for adder implementation"

**6. Latency:**
- Non-pipelined RCA: 1 cycle latency (input reg â†’ compute â†’ output reg)
- Pipelined RCA: Multiple cycles (depends on number of pipeline stages)
- Must assert `out_valid` signal only when sum is correctly computed
- Testbench accounts for latency automatically

======================================================================
TESTING & SIMULATION
======================================================================

**How to Test:**
```bash
# 1. Source environment (CRITICAL!)
source env.sh

# 2. Run simulation for RCA
make sim DUT=rca

# 3. Run simulation for pipelined RCA with M=10
make sim DUT=rca_pipe M=10

# 4. Run synthesis (no "make flow" needed!)
make synth DUT=rca
make synth DUT=rca_pipe M=10
```

**Common Testing Issues:**
- If `make sim` fails with "verilator: No such file or directory":
  â†’ Use the correct env.sh (copy from manuals/altera_impl/env.sh)
  â†’ Make sure you sourced it: `source env.sh`

- If simulation passes but Fmax is N/A:
  â†’ You must register BOTH inputs AND outputs in your RTL
  â†’ Check that you have `always_ff @(posedge clk)` for input and output regs

- If you get mismatches (e.g., "Result: ERROR - Mismatch!"):
  â†’ Likely a latency issue - check your out_valid signal timing
  â†’ Make sure you're accounting for pipeline delay

- **IMPORTANT:** If you manually change W in `top.h` to inspect waveforms, c_out may be wrong (but sum correct)
  â†’ Always use W=128 when verifying against testbench

======================================================================
QUARTUS & SYNTHESIS ISSUES
======================================================================

**Environment Setup (CRITICAL!):**
```bash
# Correct env.sh for uwing server:
export LM_LICENSE_FILE=27000@droplet.eng.uwaterloo.ca
export SALT_LICENSE_FILE=27000@droplet.eng.uwaterloo.ca
export SALT_LICENSE_SERVER=27000@droplet.eng.uwaterloo.ca

export PATH=/zfsspare/opt/Altera/altera_pro/25.1.1/quartus/bin:${PATH}
export PATH=/zfsspare/opt/Altera/altera_pro/25.1.1/questa_fse/bin:${PATH}
export PATH=/usr/local/bin:${PATH}
export PATH=/zfsspare/opt/oss-cad-suite/bin/:${PATH}

export QUARTUS_ROOTDIR=/zfsspare/opt/Altera/altera_pro/25.1.1/questa_fse/
```

**Common Quartus Issues:**

1. **License Errors:**
   - Symptom: "No license" or license request popup
   - Fix: `git pull` latest code, then `source env.sh`
   - Professor fixed env.sh on Nov 4

2. **Quartus Won't Launch:**
   - Don't run Quartus in a `screen` session - it won't work
   - Must use `ssh -X` for X11 forwarding
   - If you exit Quartus and try to reopen in same SSH session, you may get:
     `zsh: IOT instruction (core dumped)  quartus`
   - Solution: Start a new SSH session

3. **Negative Slack on Minimum Pulse Width:**
   - This is a timing constraint violation
   - May cause FPGA malfunction (missing edges, metastability)
   - Report the slack value in your CSV

4. **Fmax is N/A:**
   - You MUST register inputs AND outputs
   - Quartus needs bounding registers to calculate Fmax
   - Check your RTL has: input regs â†’ combinational logic â†’ output regs

5. **"Instance instantiates undefined entity 'rca'" Error:**
   - Problem: When synthesizing rca_pipe, Quartus can't find rca module
   - Error message: `Error (16045): Instance "col_loop[0].rca_sum_carry" instantiates undefined entity "rca"`
   - **Solution:** Add rca.sv as a dependency of rca_pipe in setup.tcl
   - Professor: "I'll allow the tcl edit"
   - Same applies for CSA: add csa.sv as dependency for csa_pipe
   - Alternative (NOT recommended): Bake rca code into rca_pipe file
     - Professor: "Nah that's silly, and possibly replicate bugs"

======================================================================
EXTRACT.SH SCRIPT ISSUES
======================================================================

**Known Bugs & Fixes:**

1. **CSA extraction doesn't work:**
   - Problem: `extract.sh` doesn't extract CSA results (for loop doesn't run)
   - Fix: Change line in extract.sh:
     ```bash
     # OLD (broken):
     [[ "$DUT" =~ "^(rca|csa)$" ]] && PATTERN="output_files_$DUT" || PATTERN="output_files_${DUT}_M${M}"
     
     # NEW (fixed):
     [[ "$DUT" =~ "^(rca)$" ]] && PATTERN="output_files_$DUT" || PATTERN="output_files_${DUT}_M${M}"
     ```
   - Reason: CSA needs M value, but old regex treated it like RCA

2. **CSA extraction still broken (Nov 10):**
   - Additional fix needed: Remove `|| [ "$DUT" = "csa" ]` from extract.sh
   - Otherwise it won't extract for csa

3. **M value not extracted for pipelined designs:**
   - Problem: extract.sh doesn't extract M value after fitter runs for rca_pipe
   - Solution: Students created custom extract.sh to handle this

4. **CSV Overwriting Issue:**
   - Problem: extract.sh overwrites rca_pipe.csv entry every time it runs
   - Example: Run for M=10, then M=8 â†’ only M=8 result shows in CSV
   - Solution: When doing M sweeps, write results to a separate CSV file
   - Professor's note: "assembling the final CSV carefully is part of your scripting task"

======================================================================
LAB 2 GRADING ISSUES (RELEVANT FOR LAB 3 CSV FORMAT)
======================================================================

**CSV Whitespace Bug:**
- Problem: Students got 0/10 on Lab 2 Q3 despite correct output
- Root cause: Extra whitespace after commas in CSV
  - Grader expected: `4,8`
  - Students had: `4, 8` (space after comma)
  - Grader doesn't strip whitespace before comparison

- Fix for your CSV output:
  ```bash
  # Remove extra spaces after commas:
  sed -i '1!s/, */,/g' lab2q3.sorted.csv
  ```
  OR modify your script to not add spaces when writing CSV

- Also check for trailing commas - golden files may have them

======================================================================
DESIGN STRUCTURE & ARCHITECTURE
======================================================================

**RCA.SV (Non-Pipelined):**
```
Input â†’ Input Registers â†’ 128-bit Adder Logic â†’ Output Registers â†’ Output
        (clk)                                      (clk)
```
- Must have clock for input/output registers (for timing analysis)
- Latency: 1 cycle

**RCA_PIPE.SV (Pipelined):**
```
Input â†’ Input Regs â†’ [RCA Module 1] â†’ Pipeline Regs â†’ [RCA Module 2] â†’ Pipeline Regs â†’ ... â†’ Output Regs â†’ Output
```
- Instantiates multiple rca.sv modules
- Each rca.sv instance has its own bounding registers (input/output regs)
- Add pipeline registers every M bits (between RCA module outputs and next inputs)
- This creates overhead: input regs â†’ compute â†’ output regs â†’ pipeline regs â†’ input regs (next stage)
- Latency: Multiple cycles (depends on number of pipeline stages)

**Key Question from Students:**
"If we instantiate 1 rca.sv module for each stage of the pipeline, what happens to the input and output registers of rca.sv instance?"

**Answer (from CreeperDrop):**
"Yes each instantiation of rca.sv will instantiate the bounding registers and you have to account for that as part of your pipelining"

**Professor's Clarification:**
- This interpretation is not quite right
- (Implied: You may not need to instantiate full rca.sv modules for each stage)
- (Likely: Just use the adder logic from rca.sv, not the full module with registers)

**CSA_PIPE.SV (Pipelined Carry-Select Adder):**
- **CRITICAL:** CSA and CSA_PIPE use M for different purposes
- Student question: "are we supposed to use csa to implement csa_pipe as well? I am not doing that right now because both csa and csa_pipe use M for different purpose"
- This suggests CSA_PIPE may not instantiate CSA modules (unlike RCA_PIPE which instantiates RCA)

**CSA Diagonal Carry Logic (Nov 11 - MAJOR DISCUSSION):**
- Initial confusion: Textbook diagram appears incomplete
- Key insight: Diagonal adders have B=0 (second operand is zero)
- **Proof that W-bit adders are sufficient (not W+1):**
  1. Two W-bit numbers can only produce W+1 bit result (max carry out = 1)
  2. Diagonal adder with B=0 can only PROPAGATE carry, never GENERATE
  3. Only ONE of these can be 1 at a time:
     - First row adder's carry out
     - Diagonal adder's cascaded carry in
  4. If first row generates carry, it absorbs the cascaded carry
  5. If first row doesn't generate carry (sum=011), cascaded carry makes it 100
  
- **Implementation:**
  - Use W-bit adders for diagonal chain
  - Combine the two carry outputs with OR gate (or XOR - both work since only one can be 1)
  - Feed first row's MSB carry to next column's diagonal adder B[0] input (where B is otherwise 0)
  - Last stage: OR the two carry bits for final carry out

- Professor: "I had to Google xor gate truth table to be sure ðŸ˜­"
- Professor: "I think I've googled xor gate truth table many many many times now"
- Professor: "I get paid six digits for this" (referring to figuring out the diagonal carry logic)

======================================================================
PARAMETRIC VERILOG & CODE GENERATION
======================================================================

**Verilator Circular Loop Warning:**
- Problem: Verilator warns about circular loops in parametric code
- Solutions:
  1. Avoid circular loops in your code
  2. Generate RTL from Python externally (pre-generate code)
  
**Parametric Verilog Limitations:**
- Verilator doesn't work well if array index depends on parameters W and M
- Only works if looping size is deterministic
- Example that fails: `assign CPA[j].carry_out` where j depends on M

**Code Generation Approach:**
- Student suggestion: Pre-generate code for all possible combinations of W and M
- Since W is fixed at 128, only vary M
- Professor: "Careful M doesn't have to be power of 2 for ece722"
- Professor: "Err not all possible Ws, just Ms"
- M values to test: Not just powers of 2, but also values with remainders (e.g., M=10, M=29)

**Hierarchical Carry-Chain Implementation:**
- Student asked about using hierarchical carry-chain: `assign CPA[j].carry_out`
- Professor: "Is it working with Verilator?"
- Student: "yes, it does"
- Professor: "Then who cares lol"
- Professor: "Only if you don't know how to write parametric verilog" (referring to Python generation)

**Generate Blocks vs Always_Comb:**
- Student: "Is there any difference for using generate and always_comb on this lab"
- Professor: "There's no relation"

======================================================================
PARAMETER SWEEPS & OPTIMIZATION
======================================================================

**What to Sweep:**
- M values (number of FAs per pipeline chunk)
- Goal: Find optimal M that maximizes Fmax while keeping ALM usage reasonable
- **M does NOT have to be power of 2!**
- **M does NOT have to divide W evenly!**
- Test M values with remainders (e.g., M=10, M=29)
- Professor: "Maaaybe" (when asked if we need to test non-divisor M values)
- Student: "That's a yes"
- Professor: "I mean you have to look at the Altera LAB" (referring to understanding FPGA architecture)

**How to Sweep:**
```bash
# Example sweep for M = 2, 4, 8, 16, 32, 64, 128
for M in 2 4 8 16 32 64 128; do
    make synth DUT=rca_pipe M=$M
    # Extract results to a separate CSV (don't let extract.sh overwrite!)
done
```

**What to Report in CSV:**
- DUT name (rca, rca_pipe, csa, csa_pipe)
- M value (for pipelined designs)
- Fmax (MHz or GHz)
- Slack (ns)
- ALM usage (exclude ALMs_VIRTUAL_IO)
- Latency (cycles)

**Edge Cases:**
- Student: "Do I have to handle W < M...? Technically you could instantiate it that way, but it's kinda stupid to do that"
- Professor: "No that wouldn't make sense"
- Student: "oops all remainder"

======================================================================
DEBUGGING TIPS
======================================================================

1. **Always source env.sh first!**
   - Copy from `manuals/altera_impl/env.sh` if needed
   - Run: `source env.sh`

2. **Check your RTL has input AND output registers:**
   ```systemverilog
   always_ff @(posedge clk) begin
       // Input registers
       a_reg <= a;
       b_reg <= b;
       cin_reg <= cin;
   end
   
   // Combinational adder logic here
   
   always_ff @(posedge clk) begin
       // Output registers
       s <= s_comb;
       cout <= cout_comb;
       out_valid <= in_valid_delayed; // Account for latency!
   end
   ```

3. **Verify your latency is correct:**
   - Use a counter or shift register to delay `in_valid` signal
   - `out_valid` should assert only when result is ready

4. **Check CSV format carefully:**
   - No extra spaces after commas
   - Check for trailing commas (match golden file format)
   - Use `cat` command to view file (don't trust GUI)

5. **Git pull regularly:**
   - Professor fixes bugs in scripts (env.sh, extract.sh, etc.)
   - Always `git pull` before starting work

6. **Don't remove/re-clone lab files carelessly:**
   - Student asked: "I removed lab3 folder and cloned again, will that cause issues?"
   - Professor: "Git-related questions should be searched on Google first"
   - Generally: Don't delete and re-clone unless you know what you're doing

7. **Use Google/debug before asking:**
   - Professor's reminder: "Git-related questions should be searched on Google first"
   - "Have you tried to debug your code and how have you done so?"

8. **Add rca.sv/csa.sv as dependencies in setup.tcl:**
   - If you get "undefined entity" errors, add dependencies
   - Professor approved this approach

9. **For CSA diagonal carry logic:**
   - Remember: Only ONE of the two carries can be 1
   - Use OR gate to combine them
   - Diagonal adder with B=0 only propagates, never generates

10. **Always use W=128 for testing:**
    - Don't manually change W in `top.h` for waveform inspection
    - If you do, c_out will be wrong (but sum correct)

======================================================================
PROFESSOR'S ADVICE & WARNINGS
======================================================================

1. **Start early!**
   - Only 2 students had started by Nov 5
   - 10 days left from Nov 5 â†’ due around Nov 15
   - Professor: "10 days left ðŸ˜­"

2. **Lab 3 is easier than Lab 2:**
   - Professor: "so much easier and not buggy as lab2. what gives?"
   - "so far no bugs" (student confirmation)

3. **Timing constraints:**
   - 1ns clock period is for pipelined designs
   - Non-pipelined 128-bit RCA won't meet 1ns
   - "Report slack as you see it" (don't worry if negative for non-pipelined)

4. **ALM usage:**
   - "Reasonable ALM usage" = strictly necessary + 5-10% tolerance
   - "That would be telling you the answer ðŸ™‚"
   - "You should reason about how many ALMs would be strictly necessary for adder implementation"

5. **Scripting is part of the lab:**
   - "Assembling the final CSV carefully is part of your scripting task"
   - You need to handle M sweeps and merge results properly

6. **No "make flow" needed:**
   - Student asked about `make flow DUT=rca`
   - Professor: "Make flow is not needed! I don't see it in the README"

7. **Grading philosophy:**
   - "This is a graduate course. Do your best."
   - No binary grading based on hitting specific targets
   - Focus on optimization and understanding

8. **M parameter flexibility:**
   - "Careful M doesn't have to be power of 2 for ece722"
   - Test various M values, including those with remainders

9. **Parametric Verilog:**
   - If your hierarchical implementation works with Verilator: "Then who cares lol"
   - Python code generation is only needed "if you don't know how to write parametric verilog"

10. **Martin's lectures are important:**
    - Professor: "Kinda feel like Martin's lectures were useful for answering these sorts of questions"
    - Re-watch if needed for understanding FPGA architecture

======================================================================
COMMON ERRORS & SOLUTIONS
======================================================================

**Error 1: "verilator: No such file or directory"**
```
make: verilator: No such file or directory
make: *** [Makefile:38: compile] Error 127
```
**Solution:** Use correct env.sh (copy from manuals/altera_impl/env.sh), then `source env.sh`

---

**Error 2: "Fmax is N/A"**
**Solution:** Register BOTH inputs AND outputs in your RTL. Quartus needs bounding registers.

---

**Error 3: "Result: ERROR - Mismatch!" (simulation fails)**
**Solution:** Latency issue. Check your `out_valid` signal timing. Make sure it accounts for pipeline delay.

---

**Error 4: "No license" or license popup**
**Solution:** `git pull` latest code, then `source env.sh`. Professor fixed this on Nov 4.

---

**Error 5: "zsh: IOT instruction (core dumped)  quartus"**
**Solution:** Don't run Quartus in screen session. Start a new SSH session if you exited Quartus.

---

**Error 6: CSV grading fails despite correct output**
**Solution:** Remove extra whitespace after commas:
```bash
sed -i '1!s/, */,/g' your_output.csv
```

---

**Error 7: extract.sh doesn't work for CSA**
**Solution:** Fix regex in extract.sh AND remove `|| [ "$DUT" = "csa" ]` (see "EXTRACT.SH SCRIPT ISSUES" section above)

---

**Error 8: extract.sh overwrites results during M sweep**
**Solution:** Write sweep results to a separate CSV file, then merge manually

---

**Error 9: "Instance instantiates undefined entity 'rca'"**
```
Error (16045): Instance "col_loop[0].rca_sum_carry" instantiates undefined entity "rca"
```
**Solution:** Add rca.sv as dependency in setup.tcl. Same for csa.sv/csa_pipe.

---

**Error 10: c_out is wrong but sum is correct**
**Solution:** Check if you manually changed W in `top.h`. Always use W=128 for testing.

---

**Error 11: Verilator circular loop warning**
**Solution:** 
1. Avoid circular loops in code
2. Generate RTL from Python externally
3. If it works with Verilator despite warning: "Then who cares lol"

======================================================================
TOOLS & COMMANDS REFERENCE
======================================================================

**Environment Setup:**
```bash
source env.sh  # Always run this first!
```

**Simulation:**
```bash
make sim DUT=rca              # Test non-pipelined RCA
make sim DUT=rca_pipe M=10    # Test pipelined RCA with M=10
make sim DUT=csa              # Test non-pipelined CSA
make sim DUT=csa_pipe M=8     # Test pipelined CSA with M=8
```

**Synthesis:**
```bash
make synth DUT=rca            # Synthesize non-pipelined RCA
make synth DUT=rca_pipe M=10  # Synthesize pipelined RCA with M=10
```

**Launch Quartus GUI:**
```bash
ssh -X username@uwing.uwaterloo.ca  # Use -X for X11 forwarding
source env.sh
quartus  # Launch GUI (don't do this in screen session!)
```

**Extract Metrics:**
```bash
./extract.sh rca              # Extract metrics for RCA
./extract.sh rca_pipe 10      # Extract metrics for RCA_PIPE with M=10
```

**Check Files:**
```bash
cat your_output.csv           # View CSV (don't trust GUI!)
git pull                      # Get latest fixes from professor
```

======================================================================
ADDITIONAL NOTES
======================================================================

- Server: uwing.uwaterloo.ca (main server for this lab)
- Server occasionally goes down (happened on Nov 4)
- Grades posted in `grading` branch of git repo (check `grade.csv`)
- Part 1 of Lab 3 is similar to Lab 2 Part 1 (reuse code if applicable)
- CSA (Carry-Select Adder) is an alternative to RCA (faster but more area)
- The CSA diagonal carry logic was a major discovery on Nov 11 - students and professor worked together to prove the textbook diagram was incomplete

======================================================================
CSA DIAGONAL CARRY LOGIC - DETAILED EXPLANATION
======================================================================

**The Problem:**
- Textbook diagram for pipelined CSA appears incomplete
- Students initially thought diagonal adders needed to be W+1 bits
- Confusion about how to handle two potential carry outputs at each stage

**The Solution (Proven by students + professor on Nov 11):**

1. **Key Insight:** Diagonal adders have B=0 (second operand is zero)

2. **Mathematical Proof:**
   - Two W-bit numbers: max result is W+1 bits (max carry = 1, not 2)
   - With B=0, diagonal adder can only PROPAGATE carry, never GENERATE
   - Example: 11 + 11 = 110 (generates carry)
   - Adding previous carry: 110 + 1 = 111 (MSB is carry out)
   - Example: 11 + 00 = 011 (no carry generated)
   - Adding previous carry: 011 + 1 = 100 (carry out from propagation)

3. **Critical Realization:**
   - Only ONE of these can be 1 at any time:
     * First row adder's carry out
     * Diagonal adder's cascaded carry in
   - They are mutually exclusive!
   - If first row generates carry â†’ it absorbs any cascaded carry
   - If first row doesn't generate carry â†’ cascaded carry propagates through

4. **Implementation:**
   - Use W-bit adders (not W+1) for diagonal chain
   - Combine two carry outputs with OR gate (or XOR - both work)
   - OR gate is simpler: "it's a LUT and less awkward to write"
   - Feed first row's MSB carry to next column's diagonal adder B[0] input

5. **Professor's Comments:**
   - "I think we can prove that W-bit adder is enough"
   - "The diagonal adder is never going to generate its own carry"
   - "It's only going to propagate a last column's carry or the MSB from the first row's adder"
   - "I had to Google xor gate truth table to be sure ðŸ˜­"
   - "I get paid six digits for this" (joking about the complexity)
   - "Taxes are twos complement subtraction on it though" (more jokes)

6. **Student Reaction:**
   - "this should not have been this difficult ðŸ˜­"
   - "soooo can we get our names on the next edition of the book?"
   - Professor: "lol email him" (referring to the textbook author)

======================================================================
QUESTIONS TO ASK CHATGPT (EXAMPLES)
======================================================================

After pasting this summary, you can ask ChatGPT:

1. "How do I structure my rca_pipe.sv to instantiate rca.sv modules with pipeline registers every M bits?"

2. "Why is my Fmax showing N/A in Quartus? I have output registers but not input registers."

3. "How do I calculate the expected latency for my pipelined RCA with M=16?"

4. "My simulation passes but I get mismatches. How do I debug the out_valid signal timing?"

5. "What's the difference between the bounding registers in rca.sv and the pipeline registers in rca_pipe.sv?"

6. "How many ALMs should a 128-bit RCA use? What's 'reasonable' usage?"

7. "How do I write a script to sweep M values and merge the results into one CSV?"

8. "Why does my CSV have extra spaces after commas and how do I fix it?"

9. "What's the best way to optimize Fmax for my pipelined adder?"

10. "How do I interpret negative slack in my timing report?"

11. "How do I implement the CSA diagonal carry logic with OR gates? Why don't I need W+1 bit adders?"

12. "How do I add rca.sv as a dependency in setup.tcl to fix the 'undefined entity' error?"

13. "What M values should I test for my parameter sweep? Do I need to test non-power-of-2 values?"

14. "How do I handle remainders when M doesn't divide W evenly?"

15. "Why is my c_out wrong but my sum correct in simulation?"

16. "How do I write parametric Verilog that works with Verilator when array indices depend on M?"

17. "Should I use Python to generate RTL or write parametric Verilog?"

18. "How do I prove that only one of the two CSA carries can be 1 at a time?"

19. "What's the difference between how M is used in CSA vs CSA_PIPE?"

20. "How will this lab be graded? Are there specific Fmax/area targets?"

======================================================================
END OF SUMMARY - PASTE EVERYTHING ABOVE INTO CHATGPT
======================================================================

Generated from 330 Discord messages (Nov 4-11, 2025)
Full message archive: ece722_Nov4-Nov11_ALL_MESSAGES.txt
