ECE722 HOMEWORK HELP - ALL MESSAGES (Nov 4-11, 2025)
Total Messages: 330
Generated: 11/11/2025, 8:46:09 PM

======================================================================

[11/4/2025] nachiketkapre: A few groups have mysterioiusly low grades. Have you checked what's up?

[11/4/2025] shadow_edwax: where could we check for our grade? I did not see any new commits about our grade.

[11/4/2025] shadow_edwax: the last commit i saw was the one fixing grade_2a.sh 5 days ago

[11/4/2025] nachiketkapre: ?? `grade.csv` in `grading` branch?

[11/4/2025] shadow_edwax: oh, the branch

[11/4/2025] jimmywzp6: The output of lab2q3 is same as golden result, but we got 0/10

[11/4/2025] nachiketkapre: run grader and check again?

[11/4/2025] shadow_edwax: strange

[11/4/2025] shadow_edwax: this is our lab3q3.csv

[11/4/2025] shadow_edwax: and this is golden

[11/4/2025] nachiketkapre: cat the file.. don't use the GUI

[11/4/2025] nachiketkapre: Ok so golden has an extra ,

can you patch csv_grader.py to account for this?

[11/4/2025] nachiketkapre: or better yet just modify your csv generator to put a trailing comma

[11/4/2025] poofypigeon: load bearing superfluous commas + whitespacce

[11/4/2025] jianxiwang: No I think it is because of the extra space after ","

[11/4/2025] jianxiwang: grader read lines based on 4,8 but they have "4, 8"

[11/4/2025] jianxiwang: and grader does not remove white space

[11/4/2025] ovs1203: Are we supposed to change 'DIR=~/ece722-f25/labs-admin/lab2' this path when running the grader across all files?

[11/4/2025] jianxiwang: @Shadow_Edwax you can just remove the extra white space after "," then it should work

[11/4/2025] shadow_edwax: yeah it's the problem of the extra space

[11/4/2025] shadow_edwax: i just removed the space and it passed

[11/4/2025] shadow_edwax: emm...okay...i didn't expect that

[11/4/2025] shadow_edwax: @nachiketkapre so what does that count? we do got the correct numbers for Q3

[11/4/2025] shadow_edwax: can we get a 10/10 for Q3?(i'm in grp 6)

[11/4/2025] nachiketkapre: wait the fix is extra whitespace??

[11/4/2025] shadow_edwax: yeah

[11/4/2025] nachiketkapre: if so, then we should update csv_grader to remove all whitespaces before comparison

[11/4/2025] shadow_edwax: trying to fix that, but seems the server crashed

[11/4/2025] jianxiwang: yes uwing is down

[11/4/2025] nachiketkapre: ugh

[11/4/2025] shadow_edwax: ideally the problem should be fixed if this line is added
sed -i '1!s/, */,/g' lab2q3.sorted.csv

[11/4/2025] shadow_edwax: but haven't tested yet

[11/4/2025] shadow_edwax: or i could just remove the space in my script when writing the output to the csv file

[11/4/2025] shadow_edwax: i think the extra space might be a reason of other groups having the low grades

[11/4/2025] nachiketkapre: please check server again?

[11/4/2025] shadow_edwax: it's back

[11/4/2025] shadow_edwax: @nachiketkapre this line works
```sed -i '1!s/, */,/g' lab2q3.sorted.csv```

[11/4/2025] qscgyj830856700: Did anyone encounter this issue while launching Quartus?
I was trying to follow the manual (altera-impl)

[11/4/2025] nachiketkapre: Did you source env.sh?

[11/4/2025] qscgyj830856700: I did

[11/4/2025] nachiketkapre: git pulled latest?

[11/4/2025] qscgyj830856700: just pulled üòÇ

[11/4/2025] nachiketkapre: The only time I've seen this is there's a licensing issue

[11/4/2025] jianxiwang: @nachiketkapre somehow today when I try `quartus` it asks for license. Yesterday I was able to run it properly without this

[11/4/2025] nachiketkapre: git pull please -- I've fixed env.sh

[11/4/2025] nachiketkapre: I just tried this and works fine!

Ôåõ ÔÅº ~/ece7/m/altera-impl on Ôáì ÔÑ¶ main ?5 ‚ùØ source env.sh
Ôåõ ÔÅº ~/ece7/m/altera-impl on Ôáì ÔÑ¶ main ?5 ‚ùØ quartus

Quartus GUI is launched!

[11/4/2025] jianxiwang: ok I can confirm it works

[11/4/2025] qscgyj830856700: same üò•

[11/4/2025] nachiketkapre: Did you ssh -X?

[11/4/2025] qscgyj830856700: Oh I see. It seems not to work in a screen session.

[11/4/2025] qscgyj830856700: Thank you Prof

[11/4/2025] jianxiwang: When I do synthesis I got no license error. however the synth in manual works fine. Anyone face the same issue?

[11/4/2025] jianxiwang: I see the issue @nachiketkapre env.sh for lab also need to be updated

[11/4/2025] qscgyj830856700: Another question: I found some negative slacks on Minimum Pulse Width check in the STA report. 
Does this mean that the FPGA might malfunction after I upload the bitstream if this issue isn't fixed?
(due to missing edge or metastability?)

[11/5/2025] nachiketkapre: @here Can I check how far along you‚Äôve come in Lab3?

[11/5/2025] nachiketkapre: Check extract.sh for an example?

[11/5/2025] peepeetee: depression

[11/5/2025] peepeetee: Also didn't sleep

[11/5/2025] peepeetee: but this is a good reminder for me to start

[11/5/2025] peepeetee: uwu

[11/5/2025] peepeetee: hold on, part 1 is just lab2 part 1

[11/5/2025] 741opamp: going to divide up the 128 FAs in the ripple carry adder into chunks of M today

[11/5/2025] jianxiwang: @nachiketkapre I have a feeling that `adder.sdc` file is not properly read from `setup.tcl` as Fmax is not available.

[11/5/2025] nachiketkapre: No it‚Äôs fine

[11/5/2025] jianxiwang: emm I think we are supposed to optimize Fmax?

[11/5/2025] nachiketkapre: Yes

[11/5/2025] jianxiwang: but how are we going to optimize fmax if it is missing for rca? I assume it will be NA just for `rca|csa` and not for `rca_pipe|csa_pipe`?

Another question is that for ALM usage are we going to exclude ALMs_VIRTUAL_IO?

[11/5/2025] jianxiwang: Will see if `_pipe` versions can generate fmax

[11/5/2025] 741opamp: fmax is not missing for rca

[11/5/2025] 741opamp: did you register your inputs and outputs?

[11/5/2025] jianxiwang: Ah input register as well

[11/5/2025] jianxiwang: Thx

[11/5/2025] 741opamp: yeah i faced the same issue

[11/5/2025] 741opamp: @nachiketkapre  No license on uwing now?

[11/5/2025] 741opamp: oh nvm

[11/5/2025] 741opamp: wait no

[11/5/2025] 741opamp: i git pulled but env.sh wasnt updated?

[11/5/2025] 741opamp: referring to this ^

[11/5/2025] jianxiwang: just use manual's env.sh for now

[11/5/2025] 741opamp: okay solid

[11/5/2025] 741opamp: thank you coaster jx

[11/5/2025] 741opamp: whaaat @CoasterJX  it failed for me

[11/5/2025] 741opamp: which server are you on?

[11/5/2025] jianxiwang: uwing?

[11/5/2025] jianxiwang: try this:

```
# export LM_LICENSE_FILE=/zfsspare/opt/Altera/LR-260383_License.dat
# export PATH=/zfsspare/opt/Altera/altera_pro/25.1.1/quartus/bin:${PATH}
# export PATH=/usr/local/bin:${PATH}
# export PATH=/zfsspare/opt/oss-cad-suite/bin/:$PATH
export LM_LICENSE_FILE=27000@droplet.eng.uwaterloo.ca
export SALT_LICENSE_FILE=27000@droplet.eng.uwaterloo.ca
export SALT_LICENSE_SERVER=27000@droplet.eng.uwaterloo.ca

export PATH=/zfsspare/opt/Altera/altera_pro/25.1.1/quartus/bin:${PATH}
export PATH=/zfsspare/opt/Altera/altera_pro/25.1.1/questa_fse/bin:${PATH}
export PATH=/usr/local/bin:${PATH}
export PATH=/zfsspare/opt/oss-cad-suite/bin/:${PATH}

export QUARTUS_ROOTDIR=/zfsspare/opt/Altera/altera_pro/25.1.1/questa_fse/
```

[11/5/2025] 741opamp: do you see any difference between your env.sh and mine? i just copied it from manuals/altera_impl/env.sh

[11/5/2025] 741opamp: my goat

[11/5/2025] 741opamp: it worked thanks

[11/5/2025] nachiketkapre: are only two kids doing the labs? üòõ

[11/5/2025] nachiketkapre: 10 days left üò≠

[11/5/2025] nachiketkapre: and so much easier and not buggy as lab2. what gives?

[11/5/2025] jianxiwang: so far no bugs

[11/5/2025] 741opamp: @nachiketkapre  does M refer to how many FAs you want per chunk or does M refer to the number of chunks/pipeline stages you want? 

I assume the latter, 
so if I say W=128 and M=2, each of the two pipeline stages will be adding up 64 bits and this fits neatly.
But if I say W=128 and M=3, are we supposed to create three pipeline stages, with the first, second and third responsible for adding up 43, 43 and 42 bits respectively?

[11/5/2025] 741opamp: okay no it looks to be the number of FAs per chunk

[11/5/2025] 741opamp: new vibecoded extract.sh because the old one does not extract the M value after fitter runs for rca_pipe  @nachiketkapre

[11/5/2025] 741opamp: wait wth happened to the file

[11/5/2025] 741opamp: okay fixed

[11/5/2025] bananamilkenjoyer443: To test the module's, you run `make sim DUT=rca` right? (For rca)

I get this error:

```
% make sim DUT=rca    
rm -rf sim
mkdir -p sim/
verilator -DTESTDIR=\"/home/a7shahba/ece722-f25/labs/grp_20-lab3/data/\" -DTOP= \
        -CFLAGS \
        -Itb\
        -Irtl\
        --clk clk\
        --cc rtl/rca.sv\
        tb/test_adder.sv \
        --exe /home/a7shahba/ece722-f25/labs/grp_20-lab3/tb/test.cpp \
        -top-module top \
        --Mdir sim/ \
        +define+TOPNAME=rca \
        +define+M=128
make: verilator: No such file or directory
make: *** [Makefile:38: compile] Error 127
```

[11/5/2025] bananamilkenjoyer443: I did run `source env.sh` too

[11/5/2025] 741opamp: @bananamilkenjoyer443  use this env.sh

[11/5/2025] jianxiwang: @nachiketkapre I assume 1ns frequency constraint is for `_pipe`?  I don't see a possibility of targeting non-pipelined 128-bit rca to 1ns

[11/5/2025] nachiketkapre: Report slack as you see it

[11/5/2025] bilal99u: In part one of the lab, 
@nachiketkapre says that we need rca.sv to be a 128 bit original adder, but it must have clock for input and output registers for timing analysis "clk is required for both original and pipelined RCA because you must have
bounding registers for inputs and outputs of your original RCA to capture
timing"
then he says "Write
rtl/rca_pipe.sv using the rtl/rca.sv file as a module and put pipeline
registers at input and output of the adder + carry every M bits"

if we instantiate 1 rca.sv module for each stage of the pipeline, what happens the input and output registers of rca.sv instance

[11/5/2025] bilal99u: if anyone knows what i am getting wrong about the structure please point out

[11/5/2025] creeperdrop: Yes each instantiaton of rca.sv will instantiate the bounding registers and you have to account for that as part of your pipelining as far as I understand

[11/6/2025] bananamilkenjoyer443: How come my Fmax is N/A?

[11/6/2025] bananamilkenjoyer443: This is for RCA, I ran the sim and passed all the tests

[11/6/2025] bananamilkenjoyer443: I didn't run `make flow DUT=rca` since the `fpga/flow.tcl` file seems to be missing. But this is the make command that seems to be doing the timing

[11/6/2025] 741opamp: ^ @bananamilkenjoyer443

[11/6/2025] nachiketkapre: Make flow is not needed! I don't see it in the README

[11/6/2025] bilal99u: In part one of the lab, 
@nachiketkapre says that we need rca.sv to be a 128 bit original adder, but it must have clock for input and output registers for timing analysis "clk is required for both original and pipelined RCA because you must have
bounding registers for inputs and outputs of your original RCA to capture
timing"
then he says "Write
rtl/rca_pipe.sv using the rtl/rca.sv file as a module and put pipeline
registers at input and output of the adder + carry every M bits"

if we instantiate 1 rca.sv module for each stage of the pipeline, what happens the input and output registers of rca.sv instance

if anyone knows what i am getting wrong about the structure please point out

[11/6/2025] bananamilkenjoyer443: @No forwarding into decode I registered my outputs, but when I register my inputs as well, I end up failing the correctness

[11/6/2025] nachiketkapre: Didn't CreeperDrop answer your question?

[11/6/2025] bilal99u: He did 
Just wanted to make sure that was correct because that adds a lot of over head 
Input to input reg then compute then output reg 
And then pipeline registers between stages

[11/6/2025] bilal99u: Also if possible bring my laptop charger today to class @nachiketkapre 
ü§ì

[11/6/2025] nachiketkapre: 10$ storage fee will be charged.

[11/6/2025] nachiketkapre: That's not quite right interpretation of his answer

[11/6/2025] bilal99u: Hst included?

[11/6/2025] 741opamp: you need to rewrite your rtl in that case. Are you asserting out_valid only when the sum is correctly computed?

[11/6/2025] 741opamp: the issue is that when Quartus reports an FMax, it is looking the largest possible time between a value changing in an input register propagating through the design and triggering a change in the output register

[11/6/2025] bananamilkenjoyer443: I'll try tinkering with the RTL. We have to pipeline input and output even for the non pipelined version right?

[11/6/2025] 741opamp: correct

[11/6/2025] bananamilkenjoyer443: Figured it out. Thanks üòÅ

[11/6/2025] jianxiwang: @nachiketkapre `extract.sh` does not work well with csa. It extracts nothing because this for loop does not run

[11/6/2025] jianxiwang: I got the fix: change line `[[ "$DUT" =~ "^(rca|csa)$" ]] && PATTERN="output_files_$DUT" || PATTERN="output_files_${DUT}_M${M}"` to `[[ "$DUT" =~ "^(rca)$" ]] && PATTERN="output_files_$DUT" || PATTERN="output_files_${DUT}_M${M}"` in `extract.sh`

[11/6/2025] jianxiwang: Since csa need M value

[11/6/2025] jianxiwang: but extraction of M is still not there

[11/6/2025] bananamilkenjoyer443: ^^^ Use this

[11/6/2025] nachiketkapre: Somehow missed this message. Thanks

[11/7/2025] lebronnjamess: i noticed that in one ssh session i can only open the quartus gui once. if i exit and try to open it again i'll get the error someone mentioned earlier:  `zsh: IOT instruction (core dumped)  quartus`

[11/7/2025] 741opamp: Note: this extract.sh will still overwrite the rca_pipe.csv entry everytime it runs. 

So if you run it once for M=10 then run it again for M=8 only the M=8 result will show

[11/7/2025] 741opamp: So when doing the sweep make sure to write the sweep results to another csv

[11/7/2025] nachiketkapre: yes, assembling the final CSV carefully is part of your scripting task

[11/7/2025] n1ko0303: getting the mismatches, eg:

Result 65534:
  Outputs : s=0x8ba6fa1a47a2c2feec02bb164ccd5cd9, c_out=0
  Expected: s=0xaa0d13f5e2d85ada738f93fe9134ef8a, c_out=1
  Result: ERROR - Mismatch!
is it because of the latency. since the rac must have 1 cycle?

[11/7/2025] n1ko0303: also I have removed the files from the lab3 folder and cloned it again will that cause any issues in the future working on the lab?

[11/7/2025] n1ko0303: uwing already had the lab3 in there with all the files in it, I just removed it and cloned it thought it was the one from the git but seems it had a lot more files in it

[11/7/2025] nachiketkapre: 1. Git-related questions should be searched on Google first.
2. I have no idea what component you‚Äôre checking and under what conditions. But in any case, have you tried to debug you code and how have you done so?

[11/7/2025] lebronnjamess: what is the scope of "reasonable ALM usage"

[11/7/2025] nachiketkapre: That would be telling you the answer üôÇ

you should reason about how many ALMs would be strictly necessary for adder implementation.

we will add a small tolerance of around 5-10%

[11/7/2025] lebronnjamess: perfect, thank you üëç

[11/7/2025] 741opamp: Looks like a latency issue to me

[11/9/2025] bilal99u: When I run rca_pipe without any changes to setup.tcl, it throws error during synthesis saying rca (on the line where i instantiate it inside rca_pipe) does not exit 
i added rca.sv as a dependency of rca_pipe and now it works perfectly. 
Am I doing something wrong or has anyone has this issue

[11/10/2025] 741opamp: I did not have that issue. I didn‚Äôt have to edit any tcl files

[11/10/2025] venkatech: Yes, I also get that error
```
Info: Elaborating from top-level entity "rca_pipe"
Info (23145): Top design parameter 'M' set with value '128' from user settings File: /home/b4venkat/ece722-f25/labs/grp_1-lab3/impl/rca_pipe_M128.qsf Line: 69
Error (16045): Instance "col_loop[0].rca_sum_carry" instantiates undefined entity "rca" File: /home/b4venkat/ece722-f25/labs/grp_1-lab3/rtl/rca_pipe.sv Line: 80
```

[11/10/2025] bilal99u: This is your issue 
I added a single line to setup.tcl to add rca to a dependency of rca_pipe 
Fixed it

[11/10/2025] venkatech: How is it working for people who haven't done that though?

[11/10/2025] bilal99u: I have no idea

[11/10/2025] nachiketkapre: I'll allow it -- I wonder if they're baking in rca code in rca_pipe file

[11/10/2025] venkatech: Are we allowed to bake in the rca code to rca_pipe? And if so, can we modify that version of rca to remove the extra registers for validity bits?

[11/10/2025] nachiketkapre: Nah that‚Äôs silly, and possibly replicate bugs

[11/10/2025] venkatech: Alright, fair enough

[11/10/2025] nachiketkapre: I‚Äôll allow the tcl edit

[11/10/2025] voar8210: This includes adding CSA dependency for CSA_pipe?

[11/10/2025] bilal99u: Yes

[11/10/2025] jianxiwang: emm are we supposed to use csa to implement csa_pipe as well? I am not doing that right now because both csa and csa_pipe use M for different purpose

[11/10/2025] jianxiwang: @nachiketkapre also `|| [ "$DUT" = "csa" ]` should be removed in extract.sh otherwise it won't extract for csa

[11/10/2025] jimmywzp6: Is there any difference for using generate and always_comb on this lab

[11/10/2025] nachiketkapre: There‚Äôs no relation

[11/11/2025] creeperdrop: @nachiketkapre if quatrus is mapping the RTL correctly post fitting as intended by the HDL but Verilator is being acting up and not interpreting correctly, who to believe?

[11/11/2025] nachiketkapre: What do you mean? It must pass functional correctness.

[11/11/2025] creeperdrop: I know that is the weird thing about it. I am modelling the FPGA-optimized pipelined adder. The sum is coming out correctly but carry out is not. I am suspecting an issue with the implementation itself now.  Tracing by hand now..

[11/11/2025] miike2844: I found that when I manually changed my width down (`W` in `top.h`) to make it easier to inspect the waveforms, the c_out was wrong (but the sum was correct). So make sure you are using W=128 if verifying against the testbench

[11/11/2025] creeperdrop: I don't remember changing anything in other files. I'll check but I remember only changing M when verifying the circuit from the make command to test the pipelining

[11/11/2025] miike2844: no worries then! just wanted to put it out there for anyone else verifying their circuit

[11/11/2025] shadow_edwax: @nachiketkapre do we need to test for M values like M=10 or 29 or any other number which will have remainder?

[11/11/2025] nachiketkapre: Maaaybe

[11/11/2025] creeperdrop: That's a yes

[11/11/2025] nachiketkapre: I mean you have to look at the Altera LAB

[11/11/2025] creeperdrop: @nachiketkapre Done tracing. The circuit in the book is broken as represented. It is missing the widths of the diagonal branch. From Florent's paper (https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=5694287), the circuit in the textbook is missing the width specifications. The diagonal adders have a W+1 input width to add the carry out of the first row. Can we add this to the "to ping Florent about: " list?

[11/11/2025] nachiketkapre: I don‚Äôt follow. Are you saying the carry out should be the +1?

[11/11/2025] creeperdrop: Yes, the width of the ones marked in blue in this diagram are the sum wires + 1 (which is the carry out bit) to be added in the diagonal adders

[11/11/2025] creeperdrop: That's why here he has the small square next to the big rectangle in the pipeline registers going through the diagonal adders

[11/11/2025] nachiketkapre: I think I understand‚Ä¶ but if it‚Äôs a W+1 bit adder are we using the MSB as carry out for next diagonal adder? Since we can only use W bits is the final sum?

[11/11/2025] creeperdrop: I don't think so? The MSB goes in the W+1 adder it is disregarded as the carry out exists anyway for this adder

[11/11/2025] creeperdrop: The problem is the inputs to the diagonals not the carry out

[11/11/2025] nachiketkapre: A W+1 bit adder will reduce a W+2 bit result?

[11/11/2025] nachiketkapre: which of those will be carry out?

[11/11/2025] poofypigeon: Guys guys, the second operand is zero

[11/11/2025] poofypigeon: you can feed the carry into there

[11/11/2025] creeperdrop: Basically yes, that is how it worked. The W+1 adder sum output gets truncated to W and the carry out is used for the carry in to the next diagonal one

[11/11/2025] creeperdrop: You will need to shift it though

[11/11/2025] poofypigeon: what? why?

[11/11/2025] creeperdrop: Because the carry out is in the M+1_th position

[11/11/2025] nachiketkapre: I‚Äôm not following this ‚Äî the carry out isn‚Äôt clean as you‚Äôve resized the adder

[11/11/2025] creeperdrop: Oh yes yes sorry I went back to my RTL. The output of the W+1 adder uses the MSB for the next c_in

[11/11/2025] nachiketkapre: Can‚Äôt you route the carry to the next adder instead???

[11/11/2025] poofypigeon: I think you can have two carries accumulate, but then you can just pass a "carry" of 2 to stage after

[11/11/2025] nachiketkapre: No I mean the W+1b result from the first level add doesn‚Äôt have to be added in the same column‚Äôs diagonal adder

[11/11/2025] nachiketkapre: It‚Äôs correct position is in the diagonal adders LSB in next column? This is where the 0 operand can be cannibalized

[11/11/2025] creeperdrop: I am lost now

[11/11/2025] nachiketkapre: You‚Äôre right that the W+1st bit must be considered but I‚Äôm not sure it needs resizing of the adder in the diagonal chain

[11/11/2025] creeperdrop: The shifting is necessary as the problimatic first row carry is from the same column

[11/11/2025] creeperdrop: At some point you will have to expand as far as I understand

[11/11/2025] nachiketkapre: But that W+1 bit has no contribution to final sum in that column

[11/11/2025] nachiketkapre: It only affects the next column

[11/11/2025] poofypigeon: you can end up in this scenario, but you just feed 2 as operand B to the next stage's adder

[11/11/2025] nachiketkapre: Exactly right ‚Äî the W+1b becomes the B[0] input where B is otherwise 0

[11/11/2025] poofypigeon: the lut should be able to absorb that addition implicitly?? but I'll need to check how it synthesizes

[11/11/2025] creeperdrop: But isn't that an extra adder?

[11/11/2025] nachiketkapre: No

[11/11/2025] nachiketkapre: It‚Äôs the existing adder in the next column

[11/11/2025] nachiketkapre: Just hijack the LSB slot

[11/11/2025] creeperdrop: Okay but what about the last stage? ü§î

[11/11/2025] poofypigeon: the full module only has 1 carry bit

[11/11/2025] poofypigeon: just take bit 0 of the two carry bits

[11/11/2025] nachiketkapre: You can only have one carry out bit

[11/11/2025] creeperdrop: Yes that is why I am confused

[11/11/2025] poofypigeon: overflow can happen

[11/11/2025] poofypigeon: that's fine

[11/11/2025] nachiketkapre: No but max overflow is when carry out is 1

[11/11/2025] nachiketkapre: It can‚Äôt be 2

[11/11/2025] poofypigeon: you're right yeah

[11/11/2025] marwanmek: the last stage would have competing carry from the first adder in that column, and the diagonal adder in the column, right?

[11/11/2025] marwanmek: could you or them together?

[11/11/2025] creeperdrop: Yes of same significance too?

[11/11/2025] poofypigeon: no wait you can have two

[11/11/2025] poofypigeon: just look at my diagram

[11/11/2025] nachiketkapre: Dude no

[11/11/2025] nachiketkapre: Two w bit number can only produce a w+1 b result

[11/11/2025] creeperdrop: yess

[11/11/2025] creeperdrop: and only 1 bit carry

[11/11/2025] nachiketkapre: So the first column holds the clue?

[11/11/2025] poofypigeon: The entire module has a carry in though

[11/11/2025] nachiketkapre: Sure but that is only used for subtraction

[11/11/2025] nachiketkapre: Never as an actual third input

[11/11/2025] creeperdrop: Are we assuming always signed?

[11/11/2025] poofypigeon: it doesn't matter

[11/11/2025] marwanmek: there's two adders in the last column, one at the first pipeline stage with carry 0, one at the last pipeline stage, 'diagonal adder'

both will generate carry bits, and we need to select one as the true carry bit for the entire number

[11/11/2025] marwanmek: I think you can just or them together and that would be correct though

[11/11/2025] poofypigeon: the only diffence between signed and unsigned addition/subtraction is context

[11/11/2025] creeperdrop: Agreed which is why i dont think assuming carry in only for subtraction is not the best

[11/11/2025] creeperdrop: probably

[11/11/2025] nachiketkapre: Signed unsigned doesn‚Äôt matter ‚Äî the carry in is a subtract signal to indicate twos complement of second operand

[11/11/2025] nachiketkapre: It‚Äôs also used to XOR the B operand when doing A-B

[11/11/2025] creeperdrop: Yes, I know but what if we are using c_in for addition though not just in a 2s complement context.

[11/11/2025] nachiketkapre: I think we should still be able to reason about this weird double carry situation

[11/11/2025] nachiketkapre: I wonder if we can prove that the diagonal adders cannot produce 2 as carry out at any stage

[11/11/2025] nachiketkapre: If B=0 is given

[11/11/2025] nachiketkapre: It maybe safe to say generate is impossible

[11/11/2025] nachiketkapre: Only propagate is possible with B=0

[11/11/2025] poofypigeon: **WLOG** for row1, col 2:
```
 11
+11
---
110
```
there's always gonna be room to add 1 without producing another carry

[11/11/2025] creeperdrop: Yes but that the last stage is the problem which is the double carry situation the prof is talking about

[11/11/2025] nachiketkapre: No

[11/11/2025] nachiketkapre: This is true at any stage

[11/11/2025] nachiketkapre: I think we can prove that W-bit adder is enough

[11/11/2025] nachiketkapre: The diagonal adder is never going to generate its own carry

[11/11/2025] nachiketkapre: It‚Äôs only going to propagate a last column‚Äôs carry or the MSB from the first row‚Äôs adder

[11/11/2025] poofypigeon: I'm convinced

[11/11/2025] nachiketkapre: So carry out is just OR gate

[11/11/2025] nachiketkapre: And that‚Äôs it?

[11/11/2025] creeperdrop: not XOR?

[11/11/2025] creeperdrop: because we are adding in the same weighted bit?

[11/11/2025] poofypigeon: this diagram _is_ poorly drawn then. The carry bits should be coming from the first stage

[11/11/2025] nachiketkapre: No you still need to combine the first row‚Äôs MSB with the last stage carry

[11/11/2025] nachiketkapre: Oh wait no

[11/11/2025] nachiketkapre: That previous stage carry won‚Äôt ripple through if the first row generates a carry

[11/11/2025] nachiketkapre: Previous stage carry only cascades to next column if current column doesn‚Äôt produce its own carry

[11/11/2025] nachiketkapre: Kapisce?

[11/11/2025] poofypigeon: I'm confused again

[11/11/2025] creeperdrop: ^^

[11/11/2025] nachiketkapre: Your example

[11/11/2025] nachiketkapre: 11+11=110

[11/11/2025] nachiketkapre: Previous stage carry will make this 111

[11/11/2025] nachiketkapre: So in this case jsut using MSB is enough for carry out

[11/11/2025] nachiketkapre: But if the current stage sum is 011

[11/11/2025] creeperdrop: But aren't we not using the carry in for the next stage then? diagonal carry

[11/11/2025] nachiketkapre: And previous column carry comes in

[11/11/2025] nachiketkapre: Then sum is 100 and this carry out was generated by the cascaded carry in

[11/11/2025] nachiketkapre: Makes sense?

[11/11/2025] poofypigeon: ahh, one generates the carry, but both cannot

[11/11/2025] nachiketkapre: Precisely

[11/11/2025] nachiketkapre: If the first row adder generates carry its game over for cascaded carry comin in ‚Äî it must be absorbed in that adder

[11/11/2025] poofypigeon: this should not have been this difficult üò≠

[11/11/2025] nachiketkapre: üòÜ

[11/11/2025] nachiketkapre: I get paid six digits for this

[11/11/2025] nachiketkapre: Taxes are twos complement subtraction on it though

[11/11/2025] creeperdrop: Then no W+1 adders

[11/11/2025] creeperdrop: I am back at square 1 now ü•≤

[11/11/2025] nachiketkapre: Jsut an OR gate for diagonal carry out is enough methinks

[11/11/2025] nachiketkapre: Only one of them will be 1

[11/11/2025] creeperdrop: Okay so just use W-width adders

[11/11/2025] nachiketkapre: Wait xor gate will do

[11/11/2025] nachiketkapre: Which is the sum generation portion of the W+1 bit adder

[11/11/2025] nachiketkapre: Then carry out is sum bit of the w+1 b adder

[11/11/2025] creeperdrop: MSB yes

[11/11/2025] nachiketkapre: I had to Google xor gate truth table to be sure üò≠

[11/11/2025] creeperdrop: That makes me feel less bad about doing this actually lol

[11/11/2025] nachiketkapre: I think I‚Äôve googled xor gate truth table many many many times now

[11/11/2025] nachiketkapre: You‚Äôd think I‚Äôd memorize it by now üò≠

[11/11/2025] creeperdrop: I always google the nand and nors too. I assumed this goes away at some point ü•≤

[11/11/2025] marwanmek: If we confirm that only one of them will generate a carry, shouldn't matter if we use an or or xor?

[11/11/2025] nachiketkapre: That‚Äôs right

[11/11/2025] marwanmek: understood using the carry in b of the next column, but now we're saying to use a w+1 instead of oring the carrys?

[11/11/2025] nachiketkapre: But it‚Äôs a LUT and less awkward to write an OR gate with rest if the FA logic

[11/11/2025] marwanmek: and use the msb of the sum in the next column b?

[11/11/2025] nachiketkapre: Yup we just proved both can‚Äôt be 1

[11/11/2025] creeperdrop: soooo can we get our names on the next edition of the book?

[11/11/2025] nachiketkapre: lol email him

[11/11/2025] creeperdrop: Probably my email will go to the spam folder right away anyway

[11/11/2025] nachiketkapre: I wonder if the CPA with B=0 can be implemented more efficiently

[11/11/2025] nachiketkapre: Maybe not.. still have to use carry chain and also have a LUT per output bit

[11/11/2025] jimmywzp6: how could I skip this warnning

[11/11/2025] nachiketkapre: 1. By avoiding circular loops in your code? 
2. Generating RTL from Python externally

[11/11/2025] peepeetee: we discussed this in class yesterday

[11/11/2025] peepeetee: oh wait wrong server

[11/11/2025] jimmywzp6: ok

[11/11/2025] peepeetee: The idea we discussed yesterday was that we don't have to actually parameterize it

[11/11/2025] peepeetee: We can pre generate code for all possible combinations of W and M

[11/11/2025] peepeetee: since W is fixed at 128(is it?) we can just vary M from 1 2 4 8 16 32 64 128

[11/11/2025] jimmywzp6: what if I use hierarchical carry-chain implementation:
like this :  assign CPA[j].carry_out  
CPA is the name of generate block

[11/11/2025] nachiketkapre: Careful M doesn‚Äôt have to be power of 2 for ece722

[11/11/2025] nachiketkapre: Is it working with Verilator?

[11/11/2025] nachiketkapre: Err not all possible Ws, just Ms

[11/11/2025] jimmywzp6: yes, it does

[11/11/2025] nachiketkapre: Then who cares lol

[11/11/2025] jimmywzp6: I thought the official way is using python

[11/11/2025] nachiketkapre: Only if you don‚Äôt know how to write parametric verilog

[11/11/2025] jianxiwang: I actually tested this one yesterday this one does not work with verilator if the index of value depends on parameter W and M

[11/11/2025] bilal99u: How will this be graded? 
Any idea? 
If we achieve some certain fmax or area targets then get grade else 0 
Like binary? 
And weight

[11/11/2025] nachiketkapre: This is a graduate course. Do your best.

[11/11/2025] jianxiwang: Only works if looping size is deterministic

[11/11/2025] bilal99u: Alrighty

[11/11/2025] peepeetee: ah, so the factors of 128

[11/11/2025] peepeetee: .......which is just the powers of 2?

[11/11/2025] peepeetee: doesn't M have to divide W?

[11/11/2025] nachiketkapre: Kinda feel like Martin‚Äôs lectures were useful for answering these sorts of questions

[11/11/2025] peepeetee: I'll re watch it

[11/11/2025] poofypigeon: Do I have to handle W < M...? Technically you could instantiate it that way, but it's kinda stupid to do that

[11/11/2025] nachiketkapre: No that wouldn‚Äôt make sense

[11/11/2025] poofypigeon: oops all remainder

